{"ast":null,"code":"import { ref, reactive } from 'vue';\nimport { ElMessage } from 'element-plus';\nimport { Upload, Folder, Play, List, Ruler, Scale, FolderOpened } from '@element-plus/icons-vue';\nimport axios from 'axios';\nconst API_BASE_URL = 'http://localhost:5000/api';\nexport default {\n  __name: 'ComparisonForm',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const form = reactive({\n      fileA: null,\n      fileB: null,\n      lengthTolerance: 5,\n      widthTolerance: 5,\n      savePath: ''\n    });\n    const results = ref([]);\n    const loading = ref(false);\n    const handleFileChange = (file, type) => {\n      form[type] = file.raw;\n    };\n    const handleSelectPath = async () => {\n      try {\n        const response = await axios.get(`${API_BASE_URL}/comparison/selectfolder`, {\n          withCredentials: true\n        });\n        if (response.data && response.data.path) {\n          form.savePath = response.data.path;\n        }\n      } catch (error) {\n        ElMessage.error('选择路径失败: ' + (error.response?.data || error.message));\n      }\n    };\n    const handleCompare = async () => {\n      if (!form.fileA || !form.fileB) {\n        ElMessage.warning('请选择需要比对的文件');\n        return;\n      }\n      if (!form.savePath) {\n        ElMessage.warning('请输入保存路径');\n        return;\n      }\n      if (!/^[a-zA-Z]:\\\\.*$/.test(form.savePath)) {\n        ElMessage.warning('请输入正确的Windows路径格式，例如：D:\\\\ExcelResults');\n        return;\n      }\n      loading.value = true;\n      try {\n        const formData = new FormData();\n        formData.append('fileA', form.fileA);\n        formData.append('fileB', form.fileB);\n        formData.append('lengthTolerance', form.lengthTolerance);\n        formData.append('widthTolerance', form.widthTolerance);\n        formData.append('savePath', form.savePath);\n        const response = await axios.post(`${API_BASE_URL}/comparison/compare`, formData, {\n          headers: {\n            'Content-Type': 'multipart/form-data',\n            'Access-Control-Allow-Origin': '*'\n          },\n          withCredentials: true\n        });\n        results.value = response.data;\n        ElMessage.success(`比对完成，文件已保存到：${form.savePath}`);\n      } catch (error) {\n        ElMessage.error('比对失败: ' + (error.response?.data || error.message));\n      } finally {\n        loading.value = false;\n      }\n    };\n    const loadResults = async () => {\n      try {\n        const response = await axios.get(`${API_BASE_URL}/comparison/results`, {\n          withCredentials: true\n        });\n        results.value = response.data;\n      } catch (error) {\n        ElMessage.error('加载历史记录失败: ' + (error.response?.data || error.message));\n      }\n    };\n    const formatDate = date => {\n      return new Date(date).toLocaleString();\n    };\n    const __returned__ = {\n      API_BASE_URL,\n      form,\n      results,\n      loading,\n      handleFileChange,\n      handleSelectPath,\n      handleCompare,\n      loadResults,\n      formatDate,\n      ref,\n      reactive,\n      get ElMessage() {\n        return ElMessage;\n      },\n      get Upload() {\n        return Upload;\n      },\n      get Folder() {\n        return Folder;\n      },\n      get Play() {\n        return Play;\n      },\n      get List() {\n        return List;\n      },\n      get Ruler() {\n        return Ruler;\n      },\n      get Scale() {\n        return Scale;\n      },\n      get FolderOpened() {\n        return FolderOpened;\n      },\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","reactive","ElMessage","Upload","Folder","Play","List","Ruler","Scale","FolderOpened","axios","API_BASE_URL","form","fileA","fileB","lengthTolerance","widthTolerance","savePath","results","loading","handleFileChange","file","type","raw","handleSelectPath","response","get","withCredentials","data","path","error","message","handleCompare","warning","test","value","formData","FormData","append","post","headers","success","loadResults","formatDate","date","Date","toLocaleString"],"sources":["D:/测试文件/数据比较/comparison-frontend/src/components/ComparisonForm.vue"],"sourcesContent":["<template>\r\n    <div class=\"comparison-container\">\r\n      <el-card class=\"form-card\">\r\n        <template #header>\r\n          <h2 class=\"card-title\">Excel文件比对系统</h2>\r\n        </template>\r\n        <el-form :model=\"form\" label-position=\"top\">\r\n          <el-row :gutter=\"20\">\r\n            <el-col :span=\"12\">\r\n              <el-form-item label=\"标准文件\">\r\n                <el-upload\r\n                  class=\"upload-demo\"\r\n                  action=\"#\"\r\n                  :on-change=\"(file) => handleFileChange(file, 'fileA')\"\r\n                  :auto-upload=\"false\"\r\n                  :show-file-list=\"true\"\r\n                >\r\n                  <el-button type=\"primary\" :icon=\"Upload\" class=\"upload-button\">\r\n                    选择标准文件\r\n                    <el-icon class=\"el-icon--right\"><Upload /></el-icon>\r\n                  </el-button>\r\n                </el-upload>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"12\">\r\n              <el-form-item label=\"待比对文件\">\r\n                <el-upload\r\n                  class=\"upload-demo\"\r\n                  action=\"#\"\r\n                  :on-change=\"(file) => handleFileChange(file, 'fileB')\"\r\n                  :auto-upload=\"false\"\r\n                  :show-file-list=\"true\"\r\n                >\r\n                  <el-button type=\"primary\" :icon=\"Upload\" class=\"upload-button\">\r\n                    选择待比对文件\r\n                    <el-icon class=\"el-icon--right\"><Upload /></el-icon>\r\n                  </el-button>\r\n                </el-upload>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n  \r\n          <el-row :gutter=\"20\">\r\n            <el-col :span=\"12\">\r\n              <el-form-item label=\"长度容差 (%)\">\r\n                <el-input-number\r\n                  v-model=\"form.lengthTolerance\"\r\n                  :min=\"0\"\r\n                  :max=\"100\"\r\n                  :precision=\"2\"\r\n                  :step=\"0.1\"\r\n                  style=\"width: 100%\"\r\n                >\r\n                  <template #prefix>\r\n                    <el-icon><Ruler /></el-icon>\r\n                  </template>\r\n                </el-input-number>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"12\">\r\n              <el-form-item label=\"宽度容差 (%)\">\r\n                <el-input-number\r\n                  v-model=\"form.widthTolerance\"\r\n                  :min=\"0\"\r\n                  :max=\"100\"\r\n                  :precision=\"2\"\r\n                  :step=\"0.1\"\r\n                  style=\"width: 100%\"\r\n                >\r\n                  <template #prefix>\r\n                    <el-icon><Scale /></el-icon>\r\n                  </template>\r\n                </el-input-number>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n  \r\n          <el-form-item label=\"保存路径\">\r\n            <el-input\r\n              v-model=\"form.savePath\"\r\n              placeholder=\"请选择保存路径\"\r\n              readonly\r\n            >\r\n              <template #prefix>\r\n                <el-icon><FolderOpened /></el-icon>\r\n              </template>\r\n              <template #append>\r\n                <el-button @click=\"handleSelectPath\" :icon=\"Folder\">\r\n                  选择路径\r\n                </el-button>\r\n              </template>\r\n            </el-input>\r\n          </el-form-item>\r\n  \r\n          <el-form-item>\r\n            <el-button type=\"primary\" @click=\"handleCompare\" :loading=\"loading\" :icon=\"Play\" class=\"action-button\">\r\n              开始比对\r\n            </el-button>\r\n            <el-button type=\"info\" @click=\"loadResults\" :icon=\"List\" class=\"action-button\">\r\n              查看历史记录\r\n            </el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </el-card>\r\n  \r\n      <el-card v-if=\"results.length > 0\" class=\"result-card\">\r\n        <template #header>\r\n          <h3 class=\"card-title\">比对结果</h3>\r\n        </template>\r\n        <el-table :data=\"results\" style=\"width: 100%\" border stripe>\r\n          <el-table-column prop=\"id\" label=\"编号\" />\r\n          <el-table-column prop=\"length\" label=\"长度\" />\r\n          <el-table-column prop=\"width\" label=\"宽度\" />\r\n          <el-table-column prop=\"status\" label=\"合格否\">\r\n            <template #default=\"scope\">\r\n              <el-tag :type=\"scope.row.status === '合格' ? 'success' : 'danger'\">\r\n                {{ scope.row.status }}\r\n              </el-tag>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"exceeded\" label=\"超出范围\" />\r\n          <el-table-column prop=\"entryTime\" label=\"录入时间\">\r\n            <template #default=\"scope\">\r\n              {{ formatDate(scope.row.entryTime) }}\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </el-card>\r\n    </div>\r\n  </template>\r\n  \r\n  <script setup>\r\n  import { ref, reactive } from 'vue'\r\n  import { ElMessage } from 'element-plus'\r\n  import { Upload, Folder, Play, List, Ruler, Scale, FolderOpened } from '@element-plus/icons-vue'\r\n  import axios from 'axios'\r\n  \r\n  const API_BASE_URL = 'http://localhost:5000/api'\r\n  \r\n  const form = reactive({\r\n    fileA: null,\r\n    fileB: null,\r\n    lengthTolerance: 5,\r\n    widthTolerance: 5,\r\n    savePath: ''\r\n  })\r\n  \r\n  const results = ref([])\r\n  const loading = ref(false)\r\n  \r\n  const handleFileChange = (file, type) => {\r\n    form[type] = file.raw\r\n  }\r\n  \r\n  const handleSelectPath = async () => {\r\n    try {\r\n      const response = await axios.get(`${API_BASE_URL}/comparison/selectfolder`, {\r\n        withCredentials: true\r\n      })\r\n      if (response.data && response.data.path) {\r\n        form.savePath = response.data.path\r\n      }\r\n    } catch (error) {\r\n      ElMessage.error('选择路径失败: ' + (error.response?.data || error.message))\r\n    }\r\n  }\r\n  \r\n  const handleCompare = async () => {\r\n    if (!form.fileA || !form.fileB) {\r\n      ElMessage.warning('请选择需要比对的文件')\r\n      return\r\n    }\r\n  \r\n    if (!form.savePath) {\r\n      ElMessage.warning('请输入保存路径')\r\n      return\r\n    }\r\n  \r\n    if (!/^[a-zA-Z]:\\\\.*$/.test(form.savePath)) {\r\n      ElMessage.warning('请输入正确的Windows路径格式，例如：D:\\\\ExcelResults')\r\n      return\r\n    }\r\n  \r\n    loading.value = true\r\n    try {\r\n      const formData = new FormData()\r\n      formData.append('fileA', form.fileA)\r\n      formData.append('fileB', form.fileB)\r\n      formData.append('lengthTolerance', form.lengthTolerance)\r\n      formData.append('widthTolerance', form.widthTolerance)\r\n      formData.append('savePath', form.savePath)\r\n  \r\n      const response = await axios.post(\r\n        `${API_BASE_URL}/comparison/compare`,\r\n        formData,\r\n        {\r\n          headers: {\r\n            'Content-Type': 'multipart/form-data',\r\n            'Access-Control-Allow-Origin': '*'\r\n          },\r\n          withCredentials: true\r\n        }\r\n      )\r\n  \r\n      results.value = response.data\r\n      ElMessage.success(`比对完成，文件已保存到：${form.savePath}`)\r\n    } catch (error) {\r\n      ElMessage.error('比对失败: ' + (error.response?.data || error.message))\r\n    } finally {\r\n      loading.value = false\r\n    }\r\n  }\r\n  \r\n  const loadResults = async () => {\r\n    try {\r\n      const response = await axios.get(`${API_BASE_URL}/comparison/results`, {\r\n        withCredentials: true\r\n      })\r\n      results.value = response.data\r\n    } catch (error) {\r\n      ElMessage.error('加载历史记录失败: ' + (error.response?.data || error.message))\r\n    }\r\n  }\r\n  \r\n  const formatDate = (date) => {\r\n    return new Date(date).toLocaleString()\r\n  }\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .comparison-container {\r\n    max-width: 1200px;\r\n    margin: 0 auto;\r\n    padding: 20px;\r\n    background: linear-gradient(to bottom right, #f0f4f8, #ffffff);\r\n    min-height: 100vh;\r\n  }\r\n  \r\n  .form-card, .result-card {\r\n    border-radius: 8px;\r\n    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);\r\n    transition: all 0.3s ease;\r\n  }\r\n  \r\n  .form-card:hover, .result-card:hover {\r\n    box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15), 0 1px 3px rgba(0, 0, 0, 0.1);\r\n  }\r\n  \r\n  .card-title {\r\n    margin: 0;\r\n    font-size: 1.75rem;\r\n    color: #2c3e50;\r\n    font-weight: 600;\r\n  }\r\n  \r\n  .el-form-item {\r\n    margin-bottom: 24px;\r\n  }\r\n  \r\n  .el-button {\r\n    margin-right: 12px;\r\n    transition: all 0.3s ease;\r\n  }\r\n  \r\n  .el-button:hover {\r\n    transform: translateY(-2px);\r\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n  }\r\n  \r\n  .el-input-number {\r\n    width: 100%;\r\n  }\r\n  \r\n  .upload-demo {\r\n    display: flex;\r\n    justify-content: center;\r\n  }\r\n  .action-button {\r\n    margin-right: 12px;\r\n    transition: all 0.3s ease;\r\n  }\r\n  .action-button:hover {\r\n    transform: translateY(-2px);\r\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n  }\r\n  </style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}