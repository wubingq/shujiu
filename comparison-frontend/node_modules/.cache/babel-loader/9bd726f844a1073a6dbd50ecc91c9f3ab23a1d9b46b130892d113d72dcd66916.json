{"ast":null,"code":"import { ref, reactive } from 'vue';\nimport { ElMessage } from 'element-plus';\nimport { Upload, Folder, VideoPlay, List, Position, ScaleToOriginal, FolderOpened } from '@element-plus/icons-vue';\nimport axios from 'axios';\nconst API_BASE_URL = 'http://localhost:5000/api';\nexport default {\n  __name: 'ComparisonForm',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const form = reactive({\n      fileA: null,\n      fileB: null,\n      lengthTolerance: 5,\n      widthTolerance: 5,\n      savePath: ''\n    });\n    const results = ref([]);\n    const loading = ref(false);\n    const currentPage = ref(1);\n    const pageSize = ref(10);\n    const dateRange = ref([]);\n    const handleFileChange = (file, type) => {\n      form[type] = file.raw;\n    };\n    const handleSelectPath = async () => {\n      try {\n        const response = await axios.get(`${API_BASE_URL}/comparison/selectfolder`, {\n          withCredentials: true\n        });\n        if (response.data && response.data.path) {\n          form.savePath = response.data.path;\n        }\n      } catch (error) {\n        ElMessage.error('选择路径失败: ' + (error.response?.data || error.message));\n      }\n    };\n    const handleCompare = async () => {\n      if (!form.fileA || !form.fileB) {\n        ElMessage.warning('请选择需要比对的文件');\n        return;\n      }\n      if (!form.savePath) {\n        ElMessage.warning('请输入保存路径');\n        return;\n      }\n      if (!/^[a-zA-Z]:\\\\.*$/.test(form.savePath)) {\n        ElMessage.warning('请输入正确的Windows路径格式，例：D:\\\\ExcelResults');\n        return;\n      }\n      loading.value = true;\n      try {\n        const formData = new FormData();\n        formData.append('fileA', form.fileB);\n        formData.append('fileB', form.filA);\n        formData.append('lengthTolerance', form.lengthTolerance);\n        formData.append('widthTolerance', form.widthTolerance);\n        formData.append('savePath', form.savePath);\n        const response = await axios.post(`${API_BASE_URL}/comparison/compare`, formData, {\n          headers: {\n            'Content-Type': 'multipart/form-data',\n            'Access-Control-Allow-Origin': '*'\n          },\n          withCredentials: true\n        });\n        results.value = response.data;\n        ElMessage.success(`比对完成，文件已保存到：${form.savePath}`);\n      } catch (error) {\n        ElMessage.error('比对失败: ' + (error.response?.data || error.message));\n      } finally {\n        loading.value = false;\n      }\n    };\n    const loadResults = async () => {\n      if (!dateRange.value || dateRange.value.length !== 2) {\n        ElMessage.warning('请选择时间区间');\n        return;\n      }\n      try {\n        const response = await axios.get(`${API_BASE_URL}/comparison/results`, {\n          params: {\n            startTime: dateRange.value[0],\n            endTime: dateRange.value[1]\n          },\n          withCredentials: true\n        });\n        results.value = response.data;\n        currentPage.value = 1; // 重置页码\n      } catch (error) {\n        ElMessage.error('加载历史记录失败: ' + (error.response?.data || error.message));\n      }\n    };\n    const formatDate = date => {\n      return new Date(date).toLocaleString();\n    };\n    const handlePageChange = val => {\n      currentPage.value = val;\n    };\n    const __returned__ = {\n      API_BASE_URL,\n      form,\n      results,\n      loading,\n      currentPage,\n      pageSize,\n      dateRange,\n      handleFileChange,\n      handleSelectPath,\n      handleCompare,\n      loadResults,\n      formatDate,\n      handlePageChange,\n      ref,\n      reactive,\n      get ElMessage() {\n        return ElMessage;\n      },\n      get Upload() {\n        return Upload;\n      },\n      get Folder() {\n        return Folder;\n      },\n      get VideoPlay() {\n        return VideoPlay;\n      },\n      get List() {\n        return List;\n      },\n      get Position() {\n        return Position;\n      },\n      get ScaleToOriginal() {\n        return ScaleToOriginal;\n      },\n      get FolderOpened() {\n        return FolderOpened;\n      },\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","reactive","ElMessage","Upload","Folder","VideoPlay","List","Position","ScaleToOriginal","FolderOpened","axios","API_BASE_URL","form","fileA","fileB","lengthTolerance","widthTolerance","savePath","results","loading","currentPage","pageSize","dateRange","handleFileChange","file","type","raw","handleSelectPath","response","get","withCredentials","data","path","error","message","handleCompare","warning","test","value","formData","FormData","append","filA","post","headers","success","loadResults","length","params","startTime","endTime","formatDate","date","Date","toLocaleString","handlePageChange","val"],"sources":["D:/测试文件/数据比较/comparison-frontend/src/components/ComparisonForm.vue"],"sourcesContent":["<template>\r\n    <div class=\"comparison-container\">\r\n      <el-card class=\"form-card\">\r\n        <template #header>\r\n          <h2 class=\"card-title\">Excel文件比对系统</h2>\r\n        </template>\r\n        <el-form :model=\"form\" label-position=\"top\">\r\n          <el-row :gutter=\"20\">\r\n            <el-col :span=\"12\">\r\n              <el-form-item label=\"标准文件\">\r\n                <el-upload\r\n                  class=\"upload-demo\"\r\n                  action=\"#\"\r\n                  :on-change=\"(file) => handleFileChange(file, 'fileA')\"\r\n                  :auto-upload=\"false\"\r\n                  :show-file-list=\"true\"\r\n                >\r\n                  <el-button type=\"primary\" :icon=\"Upload\" class=\"upload-button\">\r\n                    选择标准文件\r\n                    <el-icon class=\"el-icon--right\"><Upload /></el-icon>\r\n                  </el-button>\r\n                </el-upload>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"12\">\r\n              <el-form-item label=\"待比对文件\">\r\n                <el-upload\r\n                  class=\"upload-demo\"\r\n                  action=\"#\"\r\n                  :on-change=\"(file) => handleFileChange(file, 'fileB')\"\r\n                  :auto-upload=\"false\"\r\n                  :show-file-list=\"true\"\r\n                >\r\n                  <el-button type=\"primary\" :icon=\"Upload\" class=\"upload-button\">\r\n                    选择待比对文件\r\n                    <el-icon class=\"el-icon--right\"><Upload /></el-icon>\r\n                  </el-button>\r\n                </el-upload>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n  \r\n          <el-row :gutter=\"20\">\r\n            <el-col :span=\"12\">\r\n              <el-form-item label=\"长度容差 (%)\">\r\n                <el-input-number\r\n                  v-model=\"form.lengthTolerance\"\r\n                  :min=\"0\"\r\n                  :max=\"100\"\r\n                  :precision=\"2\"\r\n                  :step=\"0.1\"\r\n                  style=\"width: 100%\"\r\n                >\r\n                  <template #prefix>\r\n                    <el-icon><Position /></el-icon>\r\n                  </template>\r\n                </el-input-number>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"12\">\r\n              <el-form-item label=\"宽度容差 (%)\">\r\n                <el-input-number\r\n                  v-model=\"form.widthTolerance\"\r\n                  :min=\"0\"\r\n                  :max=\"100\"\r\n                  :precision=\"2\"\r\n                  :step=\"0.1\"\r\n                  style=\"width: 100%\"\r\n                >\r\n                  <template #prefix>\r\n                    <el-icon><ScaleToOriginal /></el-icon>\r\n                  </template>\r\n                </el-input-number>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n  \r\n          <el-form-item label=\"保存路径\">\r\n            <el-input\r\n              v-model=\"form.savePath\"\r\n              placeholder=\"请选择保存路径\"\r\n              readonly\r\n            >\r\n              <template #prefix>\r\n                <el-icon><FolderOpened /></el-icon>\r\n              </template>\r\n              <template #append>\r\n                <el-button @click=\"handleSelectPath\" :icon=\"Folder\">\r\n                  选择路径\r\n                </el-button>\r\n              </template>\r\n            </el-input>\r\n          </el-form-item>\r\n  \r\n          <el-form-item>\r\n            <el-button type=\"primary\" @click=\"handleCompare\" :loading=\"loading\" :icon=\"VideoPlay\" class=\"action-button\">\r\n              开始比对\r\n            </el-button>\r\n            <el-date-picker\r\n              v-model=\"dateRange\"\r\n              type=\"datetimerange\"\r\n              range-separator=\"至\"\r\n              start-placeholder=\"开始时间\"\r\n              end-placeholder=\"结束时间\"\r\n              format=\"YYYY-MM-DD HH:mm:ss\"\r\n              value-format=\"YYYY-MM-DD HH:mm:ss\"\r\n              :default-time=\"[\r\n                new Date(2000, 1, 1, 0, 0, 0),\r\n                new Date(2000, 1, 1, 23, 59, 59),\r\n              ]\"\r\n            />\r\n            <el-button type=\"info\" @click=\"loadResults\" :icon=\"List\" class=\"action-button\">\r\n              查看历史记录\r\n            </el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </el-card>\r\n  \r\n      <el-card v-if=\"results.length > 0\" class=\"result-card\">\r\n        <template #header>\r\n          <h3 class=\"card-title\">比对结果</h3>\r\n        </template>\r\n        <el-table \r\n          :data=\"results.slice((currentPage-1)*pageSize, currentPage*pageSize)\" \r\n          style=\"width: 100%\" \r\n          border \r\n          stripe>\r\n          <el-table-column prop=\"id\" label=\"编号\" />\r\n          <el-table-column prop=\"length\" label=\"长度\" />\r\n          <el-table-column prop=\"width\" label=\"宽度\" />\r\n          <el-table-column prop=\"status\" label=\"合格否\">\r\n            <template #default=\"scope\">\r\n              <el-tag :type=\"scope.row.status === '合格' ? 'success' : 'danger'\">\r\n                {{ scope.row.status }}\r\n              </el-tag>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"exceeded\" label=\"超出范围\" />\r\n          <el-table-column prop=\"entryTime\" label=\"录入时间\">\r\n            <template #default=\"scope\">\r\n              {{ formatDate(scope.row.entryTime) }}\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </el-card>\r\n  \r\n      <el-pagination\r\n        v-if=\"results.length > 0\"\r\n        :current-page=\"currentPage\"\r\n        :page-size=\"pageSize\"\r\n        :total=\"results.length\"\r\n        layout=\"total, prev, pager, next\"\r\n        @current-change=\"handlePageChange\"\r\n      />\r\n    </div>\r\n  </template>\r\n  \r\n  <script setup>\r\n  import { ref, reactive } from 'vue'\r\n  import { ElMessage } from 'element-plus'\r\n  import { \r\n    Upload,\r\n    Folder,\r\n    VideoPlay,\r\n    List,\r\n    Position,\r\n    ScaleToOriginal,\r\n    FolderOpened \r\n  } from '@element-plus/icons-vue'\r\n  import axios from 'axios'\r\n  \r\n  const API_BASE_URL = 'http://localhost:5000/api'\r\n  \r\n  const form = reactive({\r\n    fileA: null,\r\n    fileB: null,\r\n    lengthTolerance: 5,\r\n    widthTolerance: 5,\r\n    savePath: ''\r\n  })\r\n  \r\n  const results = ref([])\r\n  const loading = ref(false)\r\n  const currentPage = ref(1)\r\n  const pageSize = ref(10)\r\n  const dateRange = ref([])\r\n  \r\n  const handleFileChange = (file, type) => {\r\n    form[type] = file.raw\r\n  }\r\n  \r\n  const handleSelectPath = async () => {\r\n    try {\r\n      const response = await axios.get(`${API_BASE_URL}/comparison/selectfolder`, {\r\n        withCredentials: true\r\n      })\r\n      if (response.data && response.data.path) {\r\n        form.savePath = response.data.path\r\n      }\r\n    } catch (error) {\r\n      ElMessage.error('选择路径失败: ' + (error.response?.data || error.message))\r\n    }\r\n  }\r\n  \r\n  const handleCompare = async () => {\r\n    if (!form.fileA || !form.fileB) {\r\n      ElMessage.warning('请选择需要比对的文件')\r\n      return\r\n    }\r\n  \r\n    if (!form.savePath) {\r\n      ElMessage.warning('请输入保存路径')\r\n      return\r\n    }\r\n  \r\n    if (!/^[a-zA-Z]:\\\\.*$/.test(form.savePath)) {\r\n      ElMessage.warning('请输入正确的Windows路径格式，例：D:\\\\ExcelResults')\r\n      return\r\n    }\r\n  \r\n    loading.value = true\r\n    try {\r\n      const formData = new FormData()\r\n      formData.append('fileA', form.fileB)\r\n      formData.append('fileB', form.filA)\r\n      formData.append('lengthTolerance', form.lengthTolerance)\r\n      formData.append('widthTolerance', form.widthTolerance)\r\n      formData.append('savePath', form.savePath)\r\n  \r\n      const response = await axios.post(\r\n        `${API_BASE_URL}/comparison/compare`,\r\n        formData,\r\n        {\r\n          headers: {\r\n            'Content-Type': 'multipart/form-data',\r\n            'Access-Control-Allow-Origin': '*'\r\n          },\r\n          withCredentials: true\r\n        }\r\n      )\r\n  \r\n      results.value = response.data\r\n      ElMessage.success(`比对完成，文件已保存到：${form.savePath}`)\r\n    } catch (error) {\r\n      ElMessage.error('比对失败: ' + (error.response?.data || error.message))\r\n    } finally {\r\n      loading.value = false\r\n    }\r\n  }\r\n  \r\n  const loadResults = async () => {\r\n    if (!dateRange.value || dateRange.value.length !== 2) {\r\n      ElMessage.warning('请选择时间区间')\r\n      return\r\n    }\r\n\r\n    try {\r\n      const response = await axios.get(`${API_BASE_URL}/comparison/results`, {\r\n        params: {\r\n          startTime: dateRange.value[0],\r\n          endTime: dateRange.value[1]\r\n        },\r\n        withCredentials: true\r\n      })\r\n      results.value = response.data\r\n      currentPage.value = 1 // 重置页码\r\n    } catch (error) {\r\n      ElMessage.error('加载历史记录失败: ' + (error.response?.data || error.message))\r\n    }\r\n  }\r\n  \r\n  const formatDate = (date) => {\r\n    return new Date(date).toLocaleString()\r\n  }\r\n  \r\n  const handlePageChange = (val) => {\r\n    currentPage.value = val\r\n  }\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .comparison-container {\r\n    max-width: 1200px;\r\n    margin: 0 auto;\r\n    padding: 20px;\r\n    background: linear-gradient(to bottom right, #f0f4f8, #ffffff);\r\n    min-height: 100vh;\r\n  }\r\n  \r\n  .form-card, .result-card {\r\n    border-radius: 8px;\r\n    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);\r\n    transition: all 0.3s ease;\r\n  }\r\n  \r\n  .form-card:hover, .result-card:hover {\r\n    box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15), 0 1px 3px rgba(0, 0, 0, 0.1);\r\n  }\r\n  \r\n  .card-title {\r\n    margin: 0;\r\n    font-size: 1.75rem;\r\n    color: #2c3e50;\r\n    font-weight: 600;\r\n  }\r\n  \r\n  .el-form-item {\r\n    margin-bottom: 24px;\r\n  }\r\n  \r\n  .el-button {\r\n    margin-right: 12px;\r\n    transition: all 0.3s ease;\r\n  }\r\n  \r\n  .el-button:hover {\r\n    transform: translateY(-2px);\r\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n  }\r\n  \r\n  .el-input-number {\r\n    width: 100%;\r\n  }\r\n  \r\n  .upload-demo {\r\n    display: flex;\r\n    justify-content: center;\r\n  }\r\n  .action-button {\r\n    margin-right: 12px;\r\n    transition: all 0.3s ease;\r\n  }\r\n  .action-button:hover {\r\n    transform: translateY(-2px);\r\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n  }\r\n  </style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}