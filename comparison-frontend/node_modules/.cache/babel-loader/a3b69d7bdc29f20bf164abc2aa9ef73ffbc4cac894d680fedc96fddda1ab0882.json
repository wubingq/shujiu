{"ast":null,"code":"import axios from 'axios';\nimport { ElMessage } from 'element-plus';\nconst API_BASE_URL = 'http://localhost:5000/api';\nexport default {\n  name: 'ComparisonForm',\n  data() {\n    return {\n      form: {\n        fileA: null,\n        fileB: null,\n        lengthTolerance: 5,\n        widthTolerance: 5,\n        savePath: 'D:\\\\ExcelResults' // 默认保存路径\n      },\n      results: [],\n      loading: false\n    };\n  },\n  methods: {\n    handleFileAChange(file) {\n      this.form.fileA = file.raw;\n    },\n    handleFileBChange(file) {\n      this.form.fileB = file.raw;\n    },\n    async handleCompare() {\n      if (!this.form.fileA || !this.form.fileB) {\n        ElMessage.warning('请选择需要比对的文件');\n        return;\n      }\n      if (!this.form.savePath) {\n        ElMessage.warning('请输入保存路径');\n        return;\n      }\n      this.loading = true;\n      try {\n        const formData = new FormData();\n        formData.append('fileA', this.form.fileA);\n        formData.append('fileB', this.form.fileB);\n        formData.append('lengthTolerance', this.form.lengthTolerance);\n        formData.append('widthTolerance', this.form.widthTolerance);\n        formData.append('savePath', this.form.savePath);\n        const response = await axios.post(`${API_BASE_URL}/comparison/compare`, formData, {\n          headers: {\n            'Content-Type': 'multipart/form-data',\n            'Access-Control-Allow-Origin': '*'\n          },\n          withCredentials: true\n        });\n        this.results = response.data;\n        ElMessage.success('比对完成，文件已保存到指定路径');\n      } catch (error) {\n        ElMessage.error('比对失败: ' + (error.response?.data || error.message));\n      } finally {\n        this.loading = false;\n      }\n    },\n    async loadResults() {\n      try {\n        const response = await axios.get(`${API_BASE_URL}/comparison/results`, {\n          withCredentials: true\n        });\n        this.results = response.data;\n      } catch (error) {\n        ElMessage.error('加载历史记录失败: ' + (error.response?.data || error.message));\n      }\n    },\n    formatDate(date) {\n      return new Date(date).toLocaleString();\n    }\n  }\n};","map":{"version":3,"names":["axios","ElMessage","API_BASE_URL","name","data","form","fileA","fileB","lengthTolerance","widthTolerance","savePath","results","loading","methods","handleFileAChange","file","raw","handleFileBChange","handleCompare","warning","formData","FormData","append","response","post","headers","withCredentials","success","error","message","loadResults","get","formatDate","date","Date","toLocaleString"],"sources":["D:\\测试文件\\数据比较\\comparison-frontend\\src\\components\\ComparisonForm.vue"],"sourcesContent":["<template>\r\n    <div class=\"comparison-form\">\r\n      <el-card class=\"form-card\">\r\n        <h2>Excel文件比对系统</h2>\r\n        <el-form :model=\"form\" label-width=\"120px\">\r\n          <el-form-item label=\"标准文件\">\r\n            <el-upload\r\n              class=\"upload-demo\"\r\n              action=\"#\"\r\n              :on-change=\"handleFileAChange\"\r\n              :auto-upload=\"false\"\r\n              :show-file-list=\"true\">\r\n              <el-button type=\"primary\">选择标准文件</el-button>\r\n            </el-upload>\r\n          </el-form-item>\r\n  \r\n          <el-form-item label=\"待比对文件\">\r\n            <el-upload\r\n              class=\"upload-demo\"\r\n              action=\"#\"\r\n              :on-change=\"handleFileBChange\"\r\n              :auto-upload=\"false\"\r\n              :show-file-list=\"true\">\r\n              <el-button type=\"primary\">选择待比对文件</el-button>\r\n            </el-upload>\r\n          </el-form-item>\r\n  \r\n          <el-form-item label=\"长度容差 (%)\">\r\n            <el-input-number \r\n              v-model=\"form.lengthTolerance\" \r\n              :min=\"0\" \r\n              :max=\"100\"\r\n              :precision=\"2\" />\r\n          </el-form-item>\r\n  \r\n          <el-form-item label=\"宽度容差 (%)\">\r\n            <el-input-number \r\n              v-model=\"form.widthTolerance\" \r\n              :min=\"0\" \r\n              :max=\"100\"\r\n              :precision=\"2\" />\r\n          </el-form-item>\r\n  \r\n          <el-form-item label=\"保存路径\">\r\n            <el-input \r\n              v-model=\"form.savePath\" \r\n              placeholder=\"请输入保存路径，例如：D:\\ExcelResults\"\r\n            />\r\n          </el-form-item>\r\n  \r\n          <el-form-item>\r\n            <el-button type=\"primary\" @click=\"handleCompare\" :loading=\"loading\">\r\n              开始比对\r\n            </el-button>\r\n            <el-button type=\"info\" @click=\"loadResults\">\r\n              查看历史记录\r\n            </el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </el-card>\r\n  \r\n      <!-- 结果表格 -->\r\n      <el-card v-if=\"results.length > 0\" class=\"result-card\">\r\n        <h3>比对结果</h3>\r\n        <el-table \r\n          :data=\"results\" \r\n          style=\"width: 100%\"\r\n          border\r\n          stripe>\r\n          <el-table-column prop=\"id\" label=\"编号\" />\r\n          <el-table-column prop=\"length\" label=\"长度\" />\r\n          <el-table-column prop=\"width\" label=\"宽度\" />\r\n          <el-table-column prop=\"status\" label=\"合格否\">\r\n            <template #default=\"scope\">\r\n              <el-tag :type=\"scope.row.status === '合格' ? 'success' : 'danger'\">\r\n                {{ scope.row.status }}\r\n              </el-tag>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"exceeded\" label=\"超出范围\" />\r\n          <el-table-column prop=\"entryTime\" label=\"录入时间\">\r\n            <template #default=\"scope\">\r\n              {{ formatDate(scope.row.entryTime) }}\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </el-card>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import axios from 'axios';\r\n  import { ElMessage } from 'element-plus';\r\n  \r\n  const API_BASE_URL = 'http://localhost:5000/api';\r\n  \r\n  export default {\r\n    name: 'ComparisonForm',\r\n    data() {\r\n      return {\r\n        form: {\r\n          fileA: null,\r\n          fileB: null,\r\n          lengthTolerance: 5,\r\n          widthTolerance: 5,\r\n          savePath: 'D:\\\\ExcelResults' // 默认保存路径\r\n        },\r\n        results: [],\r\n        loading: false\r\n      }\r\n    },\r\n    methods: {\r\n      handleFileAChange(file) {\r\n        this.form.fileA = file.raw;\r\n      },\r\n      handleFileBChange(file) {\r\n        this.form.fileB = file.raw;\r\n      },\r\n      async handleCompare() {\r\n        if (!this.form.fileA || !this.form.fileB) {\r\n          ElMessage.warning('请选择需要比对的文件');\r\n          return;\r\n        }\r\n  \r\n        if (!this.form.savePath) {\r\n          ElMessage.warning('请输入保存路径');\r\n          return;\r\n        }\r\n  \r\n        this.loading = true;\r\n        try {\r\n          const formData = new FormData();\r\n          formData.append('fileA', this.form.fileA);\r\n          formData.append('fileB', this.form.fileB);\r\n          formData.append('lengthTolerance', this.form.lengthTolerance);\r\n          formData.append('widthTolerance', this.form.widthTolerance);\r\n          formData.append('savePath', this.form.savePath);\r\n  \r\n          const response = await axios.post(\r\n            `${API_BASE_URL}/comparison/compare`, \r\n            formData, \r\n            {\r\n              headers: {\r\n                'Content-Type': 'multipart/form-data',\r\n                'Access-Control-Allow-Origin': '*'\r\n              },\r\n              withCredentials: true\r\n            }\r\n          );\r\n  \r\n          this.results = response.data;\r\n          ElMessage.success('比对完成，文件已保存到指定路径');\r\n        } catch (error) {\r\n          ElMessage.error('比对失败: ' + (error.response?.data || error.message));\r\n        } finally {\r\n          this.loading = false;\r\n        }\r\n      },\r\n      async loadResults() {\r\n        try {\r\n          const response = await axios.get(`${API_BASE_URL}/comparison/results`, {\r\n            withCredentials: true\r\n          });\r\n          this.results = response.data;\r\n        } catch (error) {\r\n          ElMessage.error('加载历史记录失败: ' + (error.response?.data || error.message));\r\n        }\r\n      },\r\n      formatDate(date) {\r\n        return new Date(date).toLocaleString();\r\n      }\r\n    }\r\n  }\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .comparison-form {\r\n    max-width: 1200px;\r\n    margin: 0 auto;\r\n    padding: 20px;\r\n  }\r\n  \r\n  .form-card {\r\n    margin-bottom: 20px;\r\n  }\r\n  \r\n  .result-card {\r\n    margin-top: 20px;\r\n  }\r\n  \r\n  .el-form-item {\r\n    margin-bottom: 20px;\r\n  }\r\n  </style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}